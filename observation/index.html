<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><link href="https://yawnston.github.io/sparql2graphql/observation/" rel="canonical"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>Observation - SPARQL2GraphQL</title>
<link href="../css/theme.css" rel="stylesheet"/>
<link href="../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Observation";
        var mkdocs_page_input_path = "observation.md";
        var mkdocs_page_url = "/sparql2graphql/observation/";
      </script>
<script defer="" src="../js/jquery-3.6.0.min.js"></script>
<!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link href="../pdf/documentation.pdf" rel="alternate" title="PDF" type="application/pdf"/></head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href=".."> SPARQL2GraphQL
        </a>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="..">Home</a>
</li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/">Usage</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/">Configuration</a>
</li>
</ul>
<p class="caption"><span class="caption-text">How it works</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="./">Observation</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../model_parsing/">Parsing</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../postprocessing/">Postprocessing</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../schema/">Schema Creation</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../querying/">Querying</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../model_checkpointing/">Model Checkpointing</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hot_reloading/">Hot Reloading</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/">Development</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../editing_documentation/">Editing documentation</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="..">SPARQL2GraphQL</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a alt="Docs" class="icon icon-home" href=".."></a> »</li>
<li>How it works »</li><li>Observation</li>
<li class="wy-breadcrumbs-aside">
<a class="icon icon-github" href="https://github.com/yawnston/sparql2graphql/edit/master/docs/observation.md"> Edit on GitHub</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="observation">Observation</h1>
<p>When the application is configured, the user runs the app. Then the application
starts observing the SPARQL endpoint, and collecting observations in the form
of RDF quads (stored in the <code>QueryResult</code> type). These quads are generally
constructed to have a blank node subject representing a single observation,
and its properties then describe that observation.</p>
<h2 id="ontology">Ontology</h2>
<p>All observations conform to an ontology described in the <code>ontology.ttl</code> file,
which contains a <a href="https://www.w3.org/TR/rdf-schema/">RDFS</a> definition
of the observations in the <a href="https://www.w3.org/TR/turtle/">Turtle</a> format.</p>
<h2 id="observer-system">Observer system</h2>
<p>Observation is essentially just a process where we need to execute
many SPARQL queries, where some queries have dependencies on outputs
of previous queries. As an example, we cannot observe the existence
of properties on some class, before we even know about the class'
existence.</p>
<p>Therefore the observation logic is split up into observer classes,
namely <code>EndpointObserver</code> and <code>InitEndpointObserver</code>. These observers
each collect a specific set of observations. <code>EndpointObserver</code>s may
declare dependencies on observations produced by other observers.
<code>InitEndpointObserver</code>s do not required any previous observations to
do their observations, and they produce the initial observations
which are in turn used by other observers.</p>
<p>The flow of data between observers and their invokation is handled
by the <code>ObserverManager</code> class. It collects the outputs of its
registered observers, and triggers observers which are subscribed
to new observations accordingly.</p>
<p>Its usage looks as follows:</p>
<pre><code class="language-ts">const observerManager = new ObserverManager(config);

observerManager.subscribeInit(new ClassObserver());
observerManager.subscribe(new PropertyObserver());
observerManager.subscribe(new AttributeObserver());
observerManager.subscribe(new AssociationObserver());
observerManager.subscribe(new PropertyCountObserver());

const observations: Observations = await observerManager.runObservers();
</code></pre>
<h2 id="implemented-observers">Implemented observers</h2>
<p>While it is possible for library users to implement and use their own observers,
some observers are pre-implemented to facilitate the main flow of SPARQL2GraphQL.</p>
<p>They each collect a single kind of observation from the ontology:</p>
<ul>
<li><code>ClassObserver</code>: collects <code>ClassObservation</code>s</li>
<li><code>PropertyObserver</code>: collects <code>PropertyExistenceObservation</code>s</li>
<li><code>AttributeObserver</code>: collects <code>AttributeObservation</code>s</li>
<li><code>AssociationObserver</code>: collects <code>AssociationObservation</code>s</li>
<li><code>PropertyCountObserver</code>: collects <code>PropertyCountObservation</code>s</li>
<li><code>InstanceObserver</code>: collects <code>InstanceObservation</code>s <em>(currently unused)</em></li>
</ul>
<p>The data flow between these observers looks like this:</p>
<p><img alt="observers" src="../img/observers_diagram.png"/></p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../overview/" title="Overview"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../model_parsing/" title="Parsing">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span>
<a class="fa fa-github" href="https://github.com/yawnston/sparql2graphql" style="color: #fcfcfc"> GitHub</a>
</span>
<span><a href="../overview/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../model_parsing/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script>var base_url = '..';</script>
<script defer="" src="../js/theme_extra.js"></script>
<script defer="" src="../js/theme.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
</body>
</html>
